/* 为了防止任何可能出现的数据丢失问题，您应该先仔细检查此脚本，然后再在数据库设计器的上下文之外运行此脚本。*/
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT

BEGIN TRANSACTION
GO
ALTER TABLE dbo.ywyanzheng ADD
	CreateTime datetime NOT NULL CONSTRAINT DF_ywyanzheng_CreateTime DEFAULT getdate()
GO
ALTER TABLE dbo.ywyanzheng SET (LOCK_ESCALATION = TABLE)
GO
COMMIT



CREATE TABLE dbo.SmsSendLog
	(
	Id int NOT NULL IDENTITY (1, 1),
	CreateTime datetime NOT NULL,
	PhoneNumber nvarchar(16) NOT NULL,
	Msg nvarchar(128) NOT NULL,
	Result nvarchar(512) NOT NULL
	)  ON [PRIMARY]
GO
ALTER TABLE dbo.SmsSendLog ADD CONSTRAINT
	PK_SmsSendLog PRIMARY KEY CLUSTERED 
	(
	Id
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
ALTER TABLE dbo.SmsSendLog SET (LOCK_ESCALATION = TABLE)
GO
COMMIT


BEGIN TRANSACTION
GO
CREATE TABLE dbo.RefreshToken
	(
	Id int NOT NULL IDENTITY (1, 1),
	Token uniqueidentifier NOT NULL,
	UserId int NOT NULL,
	Timeout datetime NOT NULL,
	CreateTime datetime NOT NULL,
	IsDel bit NOT NULL,
	UpdateTime datetime NOT NULL
	)  ON [PRIMARY]
GO
ALTER TABLE dbo.RefreshToken SET (LOCK_ESCALATION = TABLE)
GO
COMMIT


BEGIN TRANSACTION
GO
CREATE TABLE dbo.AccessToken
	(
	Id int NOT NULL IDENTITY (1, 1),
	Token uniqueidentifier NOT NULL,
	UserId int NOT NULL,
	Timeout datetime NOT NULL,
	CreateTime datetime NOT NULL,
	IsDel bit NOT NULL,
	UpdateTime datetime NOT NULL
	)  ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX IX_AccessToken_Token ON dbo.AccessToken
	(
	Id
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO
ALTER TABLE dbo.AccessToken SET (LOCK_ESCALATION = TABLE)
GO
COMMIT



BEGIN TRANSACTION
GO
DROP INDEX IX_AccessToken_Token ON dbo.AccessToken
GO
ALTER TABLE dbo.AccessToken ADD CONSTRAINT
	PK_AccessToken PRIMARY KEY CLUSTERED 
	(
	Token
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
CREATE NONCLUSTERED INDEX IX_AccessToken_UserId_IsDel ON dbo.AccessToken
	(
	IsDel,
	UserId
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO
ALTER TABLE dbo.AccessToken SET (LOCK_ESCALATION = TABLE)
GO
COMMIT


BEGIN TRANSACTION
GO
ALTER TABLE dbo.RefreshToken ADD CONSTRAINT
	PK_RefreshToken PRIMARY KEY CLUSTERED 
	(
	Token
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]

GO
CREATE NONCLUSTERED INDEX IX_RefreshToken_UserId_IsDel ON dbo.RefreshToken
	(
	IsDel,
	UserId
	) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO
ALTER TABLE dbo.RefreshToken SET (LOCK_ESCALATION = TABLE)
GO
COMMIT
